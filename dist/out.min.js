var COIN_SYMBOL=null;var DRAW_SCORE=true;var CENTER_SCORE=false;var ALLOW_JUMPING=true;var FIX_VIEWPORT_WIDTH=0;var FIX_VIEWPORT_HEIGHT=0;var DEADLY_SPIKES=true;var DEBUG_COLLISIONS=false;var SLIGHTLY_SAFER_COLLISIONS=false;var GROUND_COLOR="#fff";var COIN_COLOR="#ff0";var ONLY_USE_HORIZONTAL_VELOCITY_TO_GENERATE_LINES=true;M=Math.abs;S=Math.sin;C=Math.cos;P=Math.PI;if(FIX_VIEWPORT_HEIGHT&&FIX_VIEWPORT_WIDTH){W=FIX_VIEWPORT_WIDTH;H=FIX_VIEWPORT_HEIGHT}else{W=a.width;H=a.height}x=W;y=0;v=0;w=0;t=0;
T=0;L=0;r=9;if(ALLOW_JUMPING)a.onclick=function(){T=t};s=[{x:0,y:0,u:0,v:-r,a:P/3}];
function update(now){requestAnimationFrame(update);t=t||now;f=now-t;t=now;c.strokeStyle=GROUND_COLOR;c.fillRect(0,0,W,H);w+=f/999;X=x-W/3;B=y-H/2;V=X+W;l=s[0];while(l.x<=V){A=l.a;n=r*2;q=l.x+C(A)*n;k=l.y+S(A)*n;if(ONLY_USE_HORIZONTAL_VELOCITY_TO_GENERATE_LINES)j=v;else j=Math.max(v,w);if(DEADLY_SPIKES)m=0;if(DEADLY_SPIKES&&l.d<0){o=P/3;m=-l.d}else if(DEADLY_SPIKES&&Math.random()<x/999999&&A<0&&!l.d){o=-P/3;m=A}else if(DEADLY_SPIKES&&l.d>0)o=-l.d;else o=Math.min(Math.max(A+(Math.random()-.5)*P/9,-P/
9*j),P*(x+99999)/799999*(1-j));p=(A+o)/2-P/2;if(DEADLY_SPIKES)l={x:q,y:k,u:q+C(p)*r,v:k+S(p)*(m>0?0:r),a:o,d:m};else l={x:q,y:k,u:q+C(p)*r,v:k+S(p)*r,a:o};s.unshift(l)}D=v*f;U=w*f;F=Math.atan2(U,D);G=U/D;j=0;var nextPoint;c.beginPath();do{l=s[j];c.lineTo(l.x-X,l.y-B);O=l.a-P/2;Q=M(O-F);if(nextPoint&&Q>P/2&&Q<P*3/2){K=Math.tan(l.a);if(K!=G){Z=l.v-K*l.u;if(v)q=(y-G*x-Z)/(K-G);else q=x;if(q<=nextPoint.u&&q>=l.u){k=K*q+Z;e=x-q;z=y-k;if(e*e+z*z<D*D+U*U){h=S(l.a);g=C(l.a);m=v*g+w*h;n=(v*h-w*g)*.1;v=m*g-
n*h;w=m*h+n*g;o=x+D-q;p=y+U-k;m=o*g+p*h;if(SLIGHTLY_SAFER_COLLISIONS)n=-Math.sqrt(M(m))-.1;else n=-1;x=q;y=k;D=m*g-n*h;U=m*h+n*g;L=now;if(DEADLY_SPIKES&&l.d){x=W;y=0}}}}}nextPoint=l;j++}while(nextPoint.x>X);c.stroke();x+=D;y+=U;if(ALLOW_JUMPING&&T&&M(T-L)<299){w-=.4;T=0;L=0}if(DEBUG_COLLISIONS){c.strokeStyle="#F00";c.beginPath();j=0;do{l=s[j];j++;c.lineTo(l.u-X,l.v-B);nextPoint=l}while(nextPoint.x>X);c.stroke()}c.beginPath();c.arc(x-X,y-B,r,0,P*2);if(COIN_COLOR){c.fillStyle=COIN_COLOR;c.fill();if(DRAW_SCORE){if(CENTER_SCORE)c.textAlign=
"center";c.fillText("$"+(999-(y/99|0)),x-X,y-B-r*2)}c.fillStyle="#000";if(COIN_SYMBOL)c.fillText(COIN_SYMBOL,x-X-r/2,y-B+r/2)}else c.stroke()}update(0);
