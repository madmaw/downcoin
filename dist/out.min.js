var COIN_SYMBOL=null;var DRAW_SCORE=true;var CENTER_SCORE=false;var ALLOW_JUMPING=true;var FLATTEN_AT_ZERO=false;var ZERO=999;var FIX_VIEWPORT_WIDTH=0;var FIX_VIEWPORT_HEIGHT=0;var FIX_COIN_SCALE=0;var DEADLY_SPIKES=true;var DEBUG_COLLISIONS=false;var SLIGHTLY_SAFER_COLLISIONS=false;var GROUND_COLOR="#fff";var COIN_COLOR="#ff0";var BACKGROUND_COLOR="#033";var MAX_MILLISECONDS_PER_FRAME=99;var GOOD_TOUCH=true;var RESTITUTION=.3;var DISABLE_GRADIENT_EQUALITY_CHECK=true;
var LEVEL_GENERATION_SCALE_FACTOR=2;if(FIX_VIEWPORT_HEIGHT&&FIX_VIEWPORT_WIDTH){a.width=FIX_VIEWPORT_WIDTH;a.height=FIX_VIEWPORT_HEIGHT}else if(FIX_VIEWPORT_WIDTH){a.height=FIX_VIEWPORT_WIDTH*a.height/a.width;a.width=FIX_VIEWPORT_WIDTH}x=a.width;y=0;v=0;w=0;t=0;T=0;L=0;if(FIX_COIN_SCALE)r=FIX_COIN_SCALE;else r=a.width/99;if(ALLOW_JUMPING)if(GOOD_TOUCH)onmousedown=a.ontouchstart=function(){T=t};else a.onclick=function(){T=t};s=[{x:0,y:a.height,u:0,v:a.height,a:0}];
(_=function(now,nextPoint){requestAnimationFrame(_);if(MAX_MILLISECONDS_PER_FRAME)f=Math.min(now-(t||now),MAX_MILLISECONDS_PER_FRAME);else f=now-(t||now);D=v*f;U=(FIX_COIN_SCALE?w+=f/999:w+=f*r/9999)*f;X=x-a.width/4;Y=y-a.height/2;t=now;c.fillRect(0,0,a.width,a.height);for(l=s[0];l.x<=X+a.width;s.unshift(l)){q=l.x+Math.cos(l.a)*(LEVEL_GENERATION_SCALE_FACTOR?r*LEVEL_GENERATION_SCALE_FACTOR:r);k=l.y+Math.sin(l.a)*(LEVEL_GENERATION_SCALE_FACTOR?r*LEVEL_GENERATION_SCALE_FACTOR:r);if(!FIX_COIN_SCALE)j=
x>a.width?v*r/9+(l.v-y)*4/a.width-r/50:0;else j=x>a.width?v+(l.v-y-20)/99:0;if(DEADLY_SPIKES)m=0;if(DEADLY_SPIKES&&l.d>1){o=Math.PI/3;m=1}else if(DEADLY_SPIKES&&Math.random()<x/999999&&Math.abs(l.a)<.3&&!l.d){o=-Math.PI/3;m=2}else if(FLATTEN_AT_ZERO&&k>ZERO/r)o=0;else o=Math.min(Math.max(l.d?0:l.a+(Math.random()-.5)*Math.PI/9,-Math.PI/9*j),Math.PI*(x+9999)/99999*(1-j));p=(l.a+o)/2-Math.PI/2;if(DEADLY_SPIKES)l={x:q,y:k,u:q+Math.cos(p)*r,v:k+(m>0?0:Math.sin(p)*r),a:o,d:m};else l={x:q,y:k,u:q+Math.cos(p)*
r,v:k+Math.sin(p)*r,a:o}}c.strokeStyle=GROUND_COLOR;c.beginPath();for(j=0;!nextPoint||nextPoint.x>X;nextPoint=l){l=s[j++];c.lineTo(l.x-X,l.y-Y);O=l.a-Math.PI/2;Q=Math.abs(O-Math.atan2(U,D));if(nextPoint&&Q>Math.PI/2&&Q<Math.PI*3/2){K=Math.tan(l.a);G=U/D;if(DISABLE_GRADIENT_EQUALITY_CHECK||K!=G){Z=l.v-K*l.u;if(v)q=(y-G*x-Z)/(K-G);else q=x;if(q<nextPoint.u&&q>=l.u){k=K*q+Z;e=x-q;z=y-k;if(e*e+z*z<D*D+U*U){h=Math.sin(l.a);g=Math.cos(l.a);m=v*g+w*h;if(RESTITUTION)n=(v*h-w*g)*RESTITUTION;else n=0;v=m*g-
n*h;w=m*h+n*g;o=x+D-q;p=y+U-k;m=o*g+p*h;if(SLIGHTLY_SAFER_COLLISIONS)n=-Math.sqrt(Math.abs(m))-.1;else n=-1;x=q;y=k;D=m*g-n*h;U=m*h+n*g;L=now;if(DEADLY_SPIKES&&l.d){x=a.width;y=0}}}}}}c.stroke();x+=D;y+=U;if(ALLOW_JUMPING&&T&&Math.abs(T-L)<299){if(FIX_COIN_SCALE)w=-FIX_COIN_SCALE/20;else w=-r/30;T=0;L=0}if(DEBUG_COLLISIONS){c.strokeStyle="#F00";c.beginPath();j=0;do{l=s[j];j++;c.lineTo(l.u-X,l.v-Y);nextPoint=l}while(nextPoint.x>X);c.stroke()}c.beginPath();c.arc(x-X,y-Y,r,0,Math.PI*2);if(COIN_COLOR){c.fillStyle=
COIN_COLOR;c.fill();if(DRAW_SCORE)if(CENTER_SCORE){c.textAlign="center";c.fillText("$"+(ZERO-(y/r|0)),x-X,y-Y-r*2)}else c.fillText("$"+(ZERO-(y/r|0)),x-X-r,y-Y-r*2);c.fillStyle=BACKGROUND_COLOR;if(COIN_SYMBOL)c.fillText(COIN_SYMBOL,x-X-r/2,y-Y+r/2)}else{if(BACKGROUND_COLOR)c.fillStyle=BACKGROUND_COLOR;c.stroke()}})(0);
